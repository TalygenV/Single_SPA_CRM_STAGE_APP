(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CRMManageAccount"],{"97c3":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",{staticClass:"main-content"},[e("div",{attrs:{id:"divMainLeadData"}},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 padding-t_8"},[e("div",{staticClass:"theme-primary partition-full"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("Account"))+" "+t._s(t.$t("Information")))]),e("span",{staticClass:"p-actions float-right"},[e("a",{staticClass:"p-action-btn text-white",attrs:{href:"javascript:;",title:t.$t("PageTour")},on:{click:function(a){return t.setTourGuideSteps(0)}}},[e("em",{staticClass:"fa fa-road",attrs:{"aria-hidden":"true"}}),e("br"),t._v(t._s(t.$t("PageTour")))]),e("RouterLink",{staticClass:"p-action-btn text-white float-right",attrs:{to:"/CRM/Accounts",title:"",id:"backtolist","data-original-title":t.$t("BacktoList")}},[e("em",{staticClass:"fa fa-angle-double-left pr-2"}),e("br"),t._v(t._s(t.$t("BacktoList")))])],1)])])]),e("div",{staticClass:"border p-3"},[e("Form",{ref:"form",scopedSlots:t._u([{key:"default",fn:function(a){var n=a.valid,o=a.errors;return[e("DynamicForm",{attrs:{schema:t.GroupBy,dateformat:t.dateformat,subModuleCode:"ManageAccount"},on:{openaddIndustrypopup:t.openaddIndustrypopup,FillDropdown:t.FillDropdown,onSearchDDL:t.onSearch,setSelectedValue:t.setSelectedValue}}),t.divchkhide?e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-12 col-lg-12 col-xl-12 float-left my-2"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"float-left"},[e("input",{staticClass:"ml-3",attrs:{id:"chkcontactinfo",value:"1",type:"checkbox"},on:{change:function(a){return t.ChkContactbox(a)}}})]),e("div",{staticClass:"float-left pt-1"},[e("span",{staticStyle:{"font-weight":"500"}},[t._v("Tick to add Contact.")])])])])]):t._e(),t.IscheckContact?e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12 mt-4"},[e("div",{staticClass:"heading-border mb-2"},[e("h5",{staticClass:"h5"},[e("span",[t._v(t._s(t.$t("ContactInformation")))])])])]),e("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("FirstName"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"FirstName",rules:{required:!0},label:"First Name"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.errors,o=a.touched,i=a.invalid;return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.txtfirstname,expression:"txtfirstname"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",name:"FirstName",maxlength:"100"},domProps:{value:t.txtfirstname},on:{input:function(a){a.target.composing||(t.txtfirstname=a.target.value)}}}),e("span",{staticClass:"invalid-feedback",attrs:{name:"FirstName"}},[t._v(t._s(n[0]))])]}}],null,!0)})],1)]),e("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("LastName"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"LastName",rules:{required:!0},label:"Last Name"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.errors,o=a.touched,i=a.invalid;return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.txtlastname,expression:"txtlastname"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",name:"LastName",maxlength:"100"},domProps:{value:t.txtlastname},on:{input:function(a){a.target.composing||(t.txtlastname=a.target.value)}}}),o&&i?e("span",{staticClass:"invalid-feedback",attrs:{name:"LastName"}},[t._v(t._s(n[0]))]):t._e()]}}],null,!0)})],1)]),e("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Email"))+":"),e("span",{staticClass:"text-danger"},[t._v("*")])]),e("Field",{attrs:{name:"Email",rules:{required:!0,email:!0},label:"Email"},scopedSlots:t._u([{key:"default",fn:function(a){var n=a.errors,o=a.touched,i=a.invalid;return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.txtemailid,expression:"txtemailid"}],class:{"form-control":!0,"is-invalid":o&&i},attrs:{type:"text",id:"Emailid",name:"Email"},domProps:{value:t.txtemailid},on:{input:function(a){a.target.composing||(t.txtemailid=a.target.value)}}}),e("span",{staticClass:"invalid-feedback",attrs:{name:"Email"}},[t._v(t._s(n[0]))])]}}],null,!0)})],1)]),e("div",{staticClass:"col-sm-12 col-md-12 float-left col-lg-6 col-xl-6"},[e("div",{staticClass:"form-group"},[e("label",[t._v(t._s(t.$t("Mobile"))+": ")]),e("vue-tel-input",{attrs:{id:"txtmobile",mode:"international",name:"txtmobile"},on:{input:t.onInputMobilePhone},model:{value:t.txtmobile,callback:function(a){t.txtmobile=a},expression:"txtmobile"}}),e("span",{staticClass:"invalid-feedback d-block",attrs:{name:t.txtmobile}},[t._v(t._s(o[0]))]),t.phoneError?e("span",{staticClass:"invalid-feedback d-block"},[t._v("Enter valid number.")]):t._e()],1)])]):t._e(),e("div",{staticClass:"row flex-row-reverse mt-2"},[e("div",{staticClass:"col-lg-6 text-right"},[e("a",{staticClass:"btn btn-success formbtn",class:{disabled:!1},attrs:{href:"javascript:;",title:"Save"},on:{click:function(a){return t.SubmitData(n,o)}}},[e("em",{staticClass:"fa fa-save pr-2"}),t._v(t._s(t.$t("Save"))+" ")]),t._v("Â  "),e("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:void(0)",title:"Cancel"},on:{click:t.onCancel}},[e("em",{staticClass:"fa fa-close pr-2"}),t._v(t._s(t.$t("Cancel"))+" ")])]),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2"},[e("small",{staticClass:"text-danger"},[t._v(t._s(t.$t("MandatoryString")))])])])]),t.showaddindustryModal?e("modaladdindustry",{on:{close:function(a){t.showaddindustryModal=!1},updatedata:t.UpdateSelectJson}}):t._e()]}}])})],1)],1)])},o=[],i=e("53ca"),l=(e("b0c0"),e("99af"),e("4de4"),e("d3b7"),e("498a"),e("a15b"),e("3ca3"),e("ddb0"),e("9861"),e("ac1f"),e("841c"),e("c740"),e("e9c4"),e("1276"),e("159b"),e("9769")),s=e("5ba0"),c=e("4dad"),r={components:{DynamicForm:s["a"],modaladdindustry:c["a"]},data:function(){return{isLoading:!1,value:"",LeadData:null,LeadOwner:null,GroupBy:[],Channel:null,IndustryType:null,Status:null,ApiURL:"moduleName=CRM&subModuleCode=CRM_ACCOUNTS&langCode=en",options:null,selected:!1,selectoptions:[],submited:!1,IscheckContact:!1,showaddindustryModal:!1,IndustryItemObject:null,cityItemObject:null,showaddcityModal:!1,txtfirstname:"",txtlastname:"",txtemailid:"",txtmobile:"",accountID:this.$route.params.id,divchkhide:!1,CountryData:null,phoneList:[],name:null,Id:null,dateformat:null,phoneError:!1}},created:function(){this.name=this.GetUserInfo.Name,this.Id=this.GetUserInfo.ID,this.dateformat=this.GetUserInfo.DateFormat;var t=this,a=this.$route.params.id;a=""==a?0:a;0==a&&(t.divchkhide=!0),t.FetchData()},methods:{onInputMobilePhone:function(t,a,e){t&&(a&&(null===a||void 0===a?void 0:a.formatted.length)>0&&(null===a||void 0===a||!a.valid||void 0==(null===a||void 0===a?void 0:a.valid))?this.phoneError=!0:null!==a&&void 0!==a&&a.formatted&&null!==a&&void 0!==a&&a.valid&&(t=a.formatted,this.fieldInfo.value=a.formatted,this.phoneError=!1))},onCancel:function(){this.$router.push({name:"CRMAccounts"})},IsPaste:function(t,a){var e=["commission_percentage","txtmobile","annual_revenue"];e.indexOf(a)>-1&&(IsNumeric(t.clipboardData.getData("text"))||t.preventDefault())},isNumber:function(t,a){var e=["commission_percentage","txtmobile"];if(e.indexOf(a)>-1){var n=t.which?t.which:t.keyCode;if(!(n>31&&(n<48||n>57)&&46!==n||t.currentTarget.value.length>15))return!0;t.preventDefault()}},ChkContactbox:function(t){var a=this;if(a.IscheckContact=$(t.target).prop("checked"),a.IscheckContact||(a.txtfirstname="",a.txtlastname="",a.txtemailid="",a.txtmobile=""),a.IscheckContact)a.$route.params.id},onKeyDown1:function(){ajaxRequestComplete=!0},FillDropdown:function(t,a){var e=this,n="",o="",i="";if("status_id"!=t.name){i="account_country"==t.name?"ACCOUNT_STATE":"";var s=t.name;if(n=t.value,""!=n){var c="id=&moduleName=CRM&type=".concat(i,"&refId=").concat(n);l["a"].getDDLData(c+"&search="+escape(o)).then((function(t){var a=[];null!=t.data&&(a=t.data.DATA),$.each(e.GroupBy,(function(t,e){$.each(e.Data,(function(t,e){("account_state"==e.name&&"account_country"==s||"account_city"==e.name&&"account_state"==s)&&(e.select_options=a)}))}))}))}}else"status_id"==t.name&&$.each(this.GroupBy,(function(t,a){$.each(a.Data,(function(t,a){"account_state"!=a.name&&"account_city"!=a.name||(a.is_required=!1)}))}))},openaddIndustrypopup:function(t){this.IndustryItemObject=t,this.showaddindustryModal=!0},openaddcitypopup:function(t){this.cityItemObject=t,this.showaddcityModal=!0},GetValidation:function(t){var a={};return t.is_required&&(a["required"]=!0),t.length>0&&(a["max"]=t.length),"email"==t.validation_type&&(a["email"]=!0),"date"==t.dt_code&&(a["date_format"]=String(Globalize.culture().calendar.patterns.d).toUpperCase()),"decimal"==t.dt_code&&(a["decimal"]=2),"int"!=t.dt_code&&"bigint"!=t.dt_code||(a["numeric"]=!0),"url"==t.dt_code&&(a["url"]="require_protocol"),"commission_percentage"==t.name&&(a["min_value"]=0,a["max_value"]=100,a["decimal"]=2),"account_zip_code"==t.name&&(a["numeric"]=!0,a["min"]=5,a["max"]=15),"employees"==t.name&&(a["numeric"]=!0),"account_city"==t.name&&(a["regex"]=/^[a-zA-Z ]*$/),"website"==t.name&&(a["regex"]=/^(https?: \/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})*$/),a},SubmitData:function(t){var a=this,e="",n="",o="",s="",c="",r="";a.$refs.form.validate().then((function(d){if(a.vSelectValidate=!0,d){a.isLoading=!0;var u=a.LeadData,m=[],v=[],p=[],f=0;$.each(u,(function(l,d){var u={field_name:d.name,required:d.is_required,length:d.length,type:d.validation_type};if("account_name"==d.name&&(r=d.value),"account_owner"==d.name&&(d.value=t[d.name]),"company_name"==d.name&&(e=d.value),"account_address"==d.name&&(n=d.value),"account_address2"==d.name&&(o=d.value),"account_city"==d.name&&(s=d.value),"account_zip_code"==d.name&&(c=d.value),"phone"==d.name){var _=a.phoneList.filter((function(t){return t.field_id==d.custom_field_id}));_.length>0&&(d.value=_[0].value,!_[0].isValid&&$.trim(d.value).length>0&&($("#spanPhone").show(),f++))}var h="account_id"==d.name?a.accountID:d.value;if("date"==d.dt_code&&(h=d.value),"checkbox"==d.dt_code){var C=d.select_value.filter((function(t){return null!=t&&""!=t}));h=C.join(",")}if("select"==d.dt_code)try{h="object"===Object(i["a"])(h)&&null!==h?h.value:h}catch(y){}var g={field_name:d.name,field_value:h,custom_field_id:d.custom_field_id};m.push(g),v.push(u),p.push(D)}));var _=new URLSearchParams(window.location.search),h=_.get("id")||0;_.get("AccountCode");null==h&&(h=0);var C=$('select[name="account_state"] option:selected').text(),g=e+" "+n+" "+o+" "+s+" "+("Select"==C?"--":C)+" "+c,y=a.txtfirstname+" "+a.txtlastname+" "+n+" "+o+" "+s+" "+("Select"==C?"--":C)+" "+c;if(0==h&&""==r){var b=""!=e?$.trim(g):$.trim(y),x=m[m.findIndex((function(t){return"account_name"==t.field_name}))];x.field_value=b}if(a.IscheckContact){var w=a.phoneList.filter((function(t){return"txtmobile"==t.field_id}));w.length>0&&(a.txtmobile=w[0].value,w[0].isValid||($("#spantxtmobile").show(),f++))}if(f>0)return!1;var D={first_name:a.txtfirstname,last_name:a.txtlastname,email_id:a.txtemailid,mobile_number:a.txtmobile},S=null;S=a.IscheckContact?{data:m,validation:v,accountcontact:D}:{data:m,validation:v};var I=JSON.stringify(S);l["a"].SaveAccountInfo(I).then((function(t){a.isLoading=!1,"1"==t.data[0].Code?(a.accountID>0?a.ShowAlert(a.$t("UpdatedSuccess",[a.$t("Account")]),"success",!0,a.$t("Alert")):a.ShowAlert(a.$t("AddedSuccess",[a.$t("Account")]),"success",!0,a.$t("Alert")),a.$router.push({name:"CRMAccounts"})):"2"==t.data[0].Code?a.ShowAlert(a.$t("Account name already exist"),"warning",!0,a.$t("Alert")):a.ShowAlert(a.$t("AddedError",[a.$t("Account")]),"failure",!0,a.$t("Alert"))}))}}))},UpdateSelectJson:function(t,a){$.each(this.GroupBy,(function(e,n){$.each(n.Data,(function(e,n){n.name==t&&(n.select_options=a)}))}))},FetchData:function(){var t=this;t.isLoading=!0;var a="0"==t.accountID?"":t.accountID,e=[{id:t.$route.params.AccountId,name:t.$route.params.AccountCode}],n=encodeURIComponent(JSON.stringify(e));l["a"].getFormLayout(t.ApiURL+"&id="+a+"&otherData="+n).then((function(e){if(t.isLoading=!1,t.LeadData=e.data.data,null!=t.LeadData&&t.LeadData.length>0){var n=t.LeadData[0].group_id;$.each(t.LeadData,$.proxy((function(a,e){n=e.group_id;var o=new URLSearchParams(window.location.search),i=o.get("id")||0,l=o.get("AccountCode")||"";if("industry_name"==e.name&&(e.isPlusIcon=!0),null==i&&(i=0),"date"==e.dt_code&&(e.value=""==e.value?null:e.value),0==i&&""!=l&&"account_name"==e.name&&(e.is_required=!0),"checkbox"==e.dt_code&&(e.select_value=e.value.split(",")),"account_type"==e.name&&0==t.accountID&&(e.value=t.$route.params.AccountId),"account_owner"==e.name&&(""==e.value?(e.select_value=t.name,e.value={name:e.select_value,value:t.Id,first_value:null,second_value:null},e.select_options=[{name:e.select_value,value:t.Id,first_value:null,second_value:null}]):e.select_options=t.MakeNormalArray(e.select_options)),"status_id"==e.name&&e.value,"account_state"!=e.name&&"account_city"!=e.name||(e.is_required=!1,e.select_options=null),"account_country"==e.name&&(t.CountryData=e),"account_country"==e.name&&t.accountID>0)if(""==e.value){var s=JSON.parse(t.CountryData.select_options);$.each(s,(function(a,e){"United States"==e.name&&(t.CountryData.value=e.value)})),t.FillDropdown(t.CountryData)}else t.FillDropdown(e,"Edit");"account_state"==e.name&&t.accountID>0&&t.FillDropdown(e,"Edit"),"phone"==e.name&&e.value;var c=$.grep(t.GroupBy,(function(t,a){return t.group_id==n}));if(0==c.length){var r=$.grep(t.LeadData,(function(t,a){return t.group_id==n}));if(t.accountID>0&&$.each(r,(function(a,e){"custom"==e.dropdown_type&&"Lookup"==e.picklist_options?(e.select_options=t.MakeNormalArray(e.select_options),e.select_value=e.select_options,null!=e.select_options&&e.select_options.length>0&&(e.value=e.select_options[0])):"decimal"==e.dt_code&&"YES"==e.form_field_visibility&&e.value>0?e.value=parseFloat(e.value,10):"date"==e.dt_code&&(e.value=e.value)})),r.length>0){var d={group_id:n,group_name:r[0].group_name,group_display_name:r[0].group_display_name,Data:r};t.GroupBy.push(d)}}}),t)),setTimeout((function(){t.CheckBoxBootstrap()}),100),setTimeout((function(){var e=JSON.parse(t.CountryData.select_options);""==a&&($.each(e,(function(a,e){"United States"==e.name&&(t.CountryData.value=e.value)})),t.FillDropdown(t.CountryData))}),300);var o={};t.LeadData.forEach((function(t){""!=t.astype&&"YES"==t.form_field_visibility&&(o[t.name]=t.value)}))}}))},onSearch:function(t,a,e){this.searchSelectData(t,this,a,e)},searchSelectData:function(t,a,e,n){this.ShowSearchData(t,a,e,n)},ShowSearchData:function(t,a,e,n){"undefined"==typeof n&&(n=0);var o="id=&moduleName=CRM&type="+e.field_code;"fill"!=e.dependent_type&&(o+="&refId="+n),l["a"].getDDLData(o+"&search="+escape(t)).then((function(t){var a=[];return t.data,""!=t.data&&(a=t.data),e.select_options=a.DATA,e.select_options}))},setSelectedValue:function(t,a){var e=this;try{Array.isArray(a)?t.value=a[0]:("account_owner"==t.name?e.ShowSearchData("",e,t,""):t.has_dependent>0&&$.each(e.GroupBy,$.proxy((function(n,o){$.each(o.Data,(function(n,o){o.parent_id==t.custom_field_id&&"fill"==o.dependent_type&&e.ShowSearchData("",e,o,a.value)}))}),this)),t.value=a)}catch(n){}}}},d=r,u=e("2877"),m=Object(u["a"])(d,n,o,!1,null,null,null);a["default"]=m.exports}}]);
//# sourceMappingURL=CRMManageAccount.js.map