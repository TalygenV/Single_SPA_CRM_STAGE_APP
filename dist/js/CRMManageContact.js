(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CRMManageContact"],{"72d2":function(e,t,a){"use strict";a("fbc1")},8e3:function(e,t,a){var i=a("24fb");t=i(!1),t.push([e.i,".switch{width:auto!important;overflow:unset!important}.switch .slider{left:auto!important;right:auto!important;padding:2px 7px 0 8px}.switch input:checked+.slider:before{transform:translateX(26px);left:auto;right:30px}",""]),e.exports=t},efd0:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"main-content"},[a("loader",{attrs:{"is-visible":e.isLoading}}),a("div",{attrs:{id:"divMainLeadData"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 padding-t_8"},[a("div",{staticClass:"theme-primary partition-full"},[a("span",{staticClass:"p-name text-white"},[e._v(e._s(e.$t("ManageContact")))]),a("span",{staticClass:"float-right"},[a("a",{staticClass:"p-action-btn text-white",attrs:{href:"javascript:;",title:"PageTour"},on:{click:function(t){return e.setTourGuideSteps(0)}}},[a("em",{staticClass:"fa fa-road",attrs:{"aria-hidden":"true"}}),a("br"),e._v(e._s(e.$t("PageTour"))+" ")])])])])]),a("div",{staticClass:"border p-3"},[a("Form",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.valid,n=t.errors;return[a("DynamicForm",{attrs:{schema:e.GroupBy,dateformat:e.dateformat},on:{AssignToggleValues:e.AssignToggleValues,setSelectedValue:e.setSelectedValue,onChange:e.ChangeMarital,onSearchDDL:e.onSearch}}),a("div",{staticClass:"row flex-row-reverse mt-2"},[a("div",{staticClass:"col-lg-6 text-right"},[a("a",{staticClass:"btn btn-success addContact_a",class:{disabled:!1},attrs:{href:"javascript:;",title:"Save"},on:{click:function(t){return e.SubmitData(i,n)}}},[a("em",{staticClass:"fa fa-save pr-2"}),e._v(e._s(e.$t("Save"))+" ")]),e._v("Â  "),a("a",{staticClass:"btn btn-danger",attrs:{href:"javascript:void(0)",title:"Cancel"},on:{click:e.onCancel}},[a("em",{staticClass:"fa fa-close pr-2"}),e._v(e._s(e.$t("Cancel"))+" ")])]),a("div",{staticClass:"col-lg-6"},[a("div",{staticClass:"py-2"},[a("small",{staticClass:"text-danger"},[e._v(e._s(e.$t("MandatoryString")))])])])])]}}])})],1)])],1)},n=[],s=a("b85c"),o=a("53ca"),r=(a("b0c0"),a("ac1f"),a("00b4"),a("caad"),a("2532"),a("4de4"),a("d3b7"),a("498a"),a("a15b"),a("e9c4"),a("1276"),a("313d"),a("0eb6"),a("b7ef"),a("8bd4"),a("99af"),a("b680"),a("159b"),a("9769")),l=a("5ba0"),u={components:{DynamicForm:l["a"]},data:function(){return{isLoading:!1,LeadData:null,LeadOwner:null,GroupBy:[],contactId:this.$route.params.id,Status:null,file:null,options:null,selected:!1,selectoptions:[],submited:!1,scancard:!0,vSelectValidate:!1,copied:"",message:"Copy These Text",ToCopyData:[],phoneList:[],itemMaritalValue:""}},created:function(){this.userId=this.GetUserInfo.ID,this.companyId=this.GetUserInfo.CompanyId,this.dateformat=this.GetUserInfo.DateFormat,this.FetchData()},beforeUpdate:function(){var e=this;e.ChangeMarital(e.itemMaritalValue)},methods:{onSearch:function(e,t){e&&this.searchSelectData(e,this,t)},searchSelectData:function(e,t,a){this.ShowSearchData(e,t,a,a.value.value)},ShowSearchData:function(e,t,a,i){"undefined"==typeof i&&(i=0);var n="id=&moduleName="+this.$route.params.moduleName+"&type="+a.field_code;DataService.getDDLData(n+"&search="+escape(e)).then((function(e){var t=[];return e.data,""!=e.data&&(t=e.data),a.select_options=t.DATA,a.select_options}))},setSelectedValue:function(e,t){try{Array.isArray(t)?e.value=t[0]:e.value=t.value}catch(a){}},ChangeMarital:function(e){var t=document.querySelectorAll('[name="spouse_name"]')[0];"Single"==e.value||""==e.value?$.each(this.GroupBy,(function(e,a){$.each(a.Data,(function(e,a){"spouse_name"==a.name&&(a.disabled=!0,"undefined"!=typeof t&&null!=t&&(t.disabled=!0))}))})):$.each(this.GroupBy,(function(e,a){$.each(a.Data,(function(e,a){"spouse_name"==a.name&&(a.disabled=!1,"undefined"!=typeof t&&null!=t&&(t.disabled=!1))}))}))},AssignToggleValues:function(e,t,a,i,n){var s="";if(e.target.checked){var r=$.grep(a,(function(e,t){return"yes"==String(e.value).toLowerCase()||"1"==String(e.value).toLowerCase()||"true"==String(e.value).toLowerCase()||"public"==String(e.value).toLowerCase()||"male"==String(e.value).toLowerCase()}));null!=r&&r.length>0&&(s="object"===Object(o["a"])(r[0])&&null!==r[0]?r[0].value:r[0])}else{r=$.grep(a,(function(e,t){return"no"==String(e.value).toLowerCase()||"0"==String(e.value).toLowerCase()||"false"==String(e.value).toLowerCase()||"private"==String(e.value).toLowerCase()||"female"==String(e.value).toLowerCase()}));null!=r&&r.length>0&&(s="object"===Object(o["a"])(r[0])&&null!==r[0]?r[0].value:r[0])}"0"==s?s=0:"1"==s&&(s=1),t.value=s},GetLocalizedValue:function(e,t){if(this.isBlank(t)){var a=this.$t(String(e).toUpperCase());return a||/^\s*$/.test(a)?a:(a=this.$t(String(e)),a||/^\s*$/.test(a)?a:e)}a=this.$t(String(t).toUpperCase());return a||/^\s*$/.test(a)?a:(a=this.$t(String(t)),a||/^\s*$/.test(a)?a:t)},GetFieldPlaceHolder:function(e,t,a){var i=this.GetLocalizedValue(e,t);return i="select"==a?this.$t("SelectField")+i:this.$t("EnterField")+i,i},isBlank:function(e){return!e||/^\s*$/.test(e)},SubmitData:function(e,t){var a=this,i=this,n="";i=this;this.$refs.form.validate().then((function(e){if(i.vSelectValidate=!0,e){i.submited=!0,i.isLoading=!0;var t=a.LeadData,s=[],l=[],u=0;if($.each(t,(function(e,t){var a={field_name:t.name,required:t.is_required,length:t.length,type:t.validation_type},n="contact_id"==t.name?i.contactId:t.value;if("date"==t.dt_code&&(n=t.value),"gender"!=t.name||""!=t.value&&"0"!=t.value||(n=""==t.value||"0"==t.value?"Female":t.value),null!=n&&"object"!=Object(o["a"])(n)&&n.includes("'")&&(n=escape(n)),"mobile_phone"==t.name||"home_phone"==t.name||"business_phone"==t.name){var r=i.phoneList.filter((function(e){return e.field_id==t.custom_field_id}));r.length>0&&(t.value=$.trim(r[0].value),n=$.trim(r[0].value),!r[0].isValid&&$.trim(t.value).length>0&&u++)}if("checkbox"==t.dt_code){var c=t.select_value.filter((function(e){return null!=e&&""!=e}));n=c.join(",")}if("select"==t.dt_code)try{n="object"===Object(o["a"])(n)&&null!==n?n.value:n}catch(p){}var d={field_name:t.name,field_value:n,custom_field_id:t.custom_field_id};s.push(d),l.push(a)})),u>0)return i.submited=!1,!1;var c={data:s,validation:l,fileObj:n},d=JSON.stringify(c);r["a"].SaveContact(d).then((function(e){i.isLoading=!1,"1"==e.data[0].Code?(i.contactId>0?i.ShowAlert(i.$t("UpdatedSuccess",[i.$t("Contacts")]),"Success",!0,i.$t("Alert")):i.ShowAlert(i.$t("AddedSuccess",[i.$t("Contacts")]),"Success",!0,i.$t("Alert")),i.$router.push({name:"ContactListing"})):"-1"==e.data[0].Code?i.ShowAlert(i.$t("AlreadyExists",[i.$t("Email")]),"warning",!0,i.$t("Alert")):i.ShowAlert(i.$t("AddedError",[i.$t("Contacts")]),"error",!0,i.$t("Alert")),i.submited=!1}))}}))},MakeArray:function(e,t){var a=[],i=String(e).split(",");if("radio"==t||"checkbox"==t){if(i.length>0){var n,o=Object(s["a"])(i);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r.split("|").length>1){var l={name:r.split("|")[0],value:r.split("|")[1]};a.push(l)}else{l={name:r,value:r};a.push(l)}}}catch(d){o.e(d)}finally{o.f()}}}else if(i.length>0){var u,c=Object(s["a"])(i);try{for(c.s();!(u=c.n()).done;){r=u.value,l={name:r,value:r};a.push(l)}}catch(d){c.e(d)}finally{c.f()}}return a},copytext:function(e){this.copied=e},MakeNormalArray:function(e){if(e)try{return JSON.parse(e)}catch(t){return e}else e=[]},MakeSelectArray:function(e){var t=[],a=String(e.select_options).split(",");if(a.length>0&&"Lookup"==e.picklist_options&&"YES"==e.form_field_visibility&&"select"==e.dt_code){var i={name:a[0],value:a[1]};t.push(i)}return t},GetValidation:function(e){var t={};return e.is_required&&(t["required"]=!0),"email"==e.validation_type&&(t["email"]=!0),"date"==e.dt_code&&(t["date_format"]=String(Globalize.culture().calendar.patterns.d).toUpperCase()),"decimal"==e.dt_code&&(t["decimal"]=2),"zipcode"==e.name&&(t["numeric"]=!0,t["min"]=5,t["max"]=15),"int"!=e.dt_code&&"bigint"!=e.dt_code||(t["numeric"]=!0),"url"==e.dt_code&&(t["url"]="require_protocol"),null!=e.regular_expression&&""!=e.regular_expression&&(t["regex"]=e.regular_expression),t},saveimg:function(){var e=this,t=JSON.stringify(this.fileData);this.$http.post("http://stagebcard.talygen.com/api/scan",{postString:t}).then((function(t){if(t.headers.get("Expires"),null!=t.body){var a=t.body;e.copied="",$.each(e.GroupBy,(function(e,t){$.each(t.LeadData,(function(e,t){"first_name"==t.name&&(this.value=a.Name),"mobile_phone"==t.name&&(this.value=a.PhoneNumber),"email_id"==t.name&&(this.value=a.EmailId),"zipcode"==t.name&&(this.value=a.ZipCode),"personal_notes"==t.name&&(this.value=a.Other)}))}))}$("#ShowData").removeClass("d-none"),$("#ShowData").removeClass("d-none"),setTimeout((function(){enabledrag()}),1e3)}),(function(e){}))},saveimgnew:function(){File.prototype.convertToBase64=function(e){var t=new FileReader;t.onloadend=function(t){e(t.target.result,t.target.error)},t.readAsDataURL(this)};var e=this.fileData[0].base64String,t="data:image/jpeg;base64,"+e;bcr.recognizeBcr(t,displayResult,displayProgress)},displayResult:function(e){this.ToCopyData=[];var t=e.result,a=this;$.each(e.blocks,(function(t){a.ToCopyData.push(e.blocks[t].text)})),$.each(this.GroupBy,(function(e,a){$.each(a.LeadData,(function(e,a){"first_name"==a.name&&(this.value=t.Name.Text),"job_title"==a.name&&(this.value=t.Job),"mobile_phone"==a.name&&(this.value=t.Mobile),"business_phone"==a.name&&(this.value=t.Phone),"email_id"==a.name&&(this.value=t.Email),"address_street_1"==a.name&&(this.value=t.Address.Text)}))})),setTimeout((function(){enabledrag()}),500)},displayResultEdit:function(e){this.ToCopyData=[];var t=this;$.each(e.blocks,(function(a){t.ToCopyData.push(e.blocks[a].text)})),setTimeout((function(){enabledrag()}),500)},fetchImageDetails:function(){var e=this,t=JSON.stringify(this.fileData);r["a"].UploadFile(t).then((function(t){if("Success"==t.data[0].Status){var a=alertR(e.$t("AddedSuccess")+e.$t("Attachment"));e.$emit("close"),checkVue.loadData("attachments"),setTimeout((function(){a.modal("hide")}),1500)}}))},GetBase64String:function(e){$("#showscancard").removeClass("d-none");var t=document.querySelector("input[type=file]"),a=t.files[0];drawOnCanvas(a);var i=this;i.fileData=[];var n=e.target.files[0],s=new FileReader;s.onload=function(e){return function(e){var t=e.target.result,a=window.btoa(t),s=n.name,o=s.lastIndexOf("."),r=s.substring(o+1,s.length),l='{"ContentType":"'+n.type+'","Size":"'+n.size+'","Extension":"'+r+'"}',u=["image/gif","image/jpeg","image/png"];if(!u.includes(n.type))return $("#showscancard").addClass("d-none"),i.ShowAlert(this.$t("selectimage"),"warning",!0,this.$t("Alert")),!1;s=n.name,fileObj={attachement_mime:l,fileName:s,userId:$("input[name='imageupload']").attr("userid"),companyId:$("input[name='imageupload']").attr("companyid"),id:$("input[name='imageupload']").attr("id"),moduleName:$("input[name='imageupload']").attr("modulename"),subModuleCode:$("input[name='imageupload']").attr("submodulecode"),containerName:$("input[name='imageupload']").attr("containername"),base64String:a},i.fileData.push(fileObj),i.saveimgnew()}}(),s.readAsBinaryString(n)},FetchData:function(){var e=this;e.isLoading=!0;var t="id=".concat(e.$route.params.id,"&moduleName=").concat(e.$route.params.moduleName,"&subModuleCode=").concat(e.$route.params.subModuleCode,"&langCode=en");r["a"].getFormLayout(t).then((function(t){e.isLoading=!1;var a="",i="",n="",s=[];if(null!=t.data.imageData&&""!=t.data.imageData&&($("#showscancard").removeClass("d-none"),drawOnCanvasEdit(t.data.imageData[0]),setTimeout((function(){getbase64str()}),1e3)),e.LeadData=t.data.data,null!=e.LeadData&&e.LeadData.length>0){var o=e.LeadData[0].group_id;if($.each(e.LeadData,$.proxy((function(t,r){o=r.group_id,"checkbox"==r.dt_code&&(r.select_value=r.value.split(",")),"mobile_phone"==r.name&&(a=r.value,""!=a&&null!=a&&-1!=a.indexOf("+")||s.push(r.name)),"home_phone"==r.name&&(i=r.value,""!=i&&null!=i&&-1!=i.indexOf("+")||s.push(r.name)),"business_phone"==r.name&&(n=r.value,""!=n&&null!=n&&-1!=n.indexOf("+")||s.push(r.name)),"marital_status"==r.name&&(e.itemMaritalValue=r);var l=$.grep(e.GroupBy,(function(e,t){return e.group_id==o}));if(0==l.length){var u=$.grep(e.LeadData,(function(e,t){return e.group_id==o}));if(e.contactId>0&&(e.scancard=!1,$.each(u,(function(t,a){null!=a.value&&(a.value=unescape(a.value)),"custom"==a.dropdown_type&&"Lookup"==a.picklist_options?(a.select_options=e.MakeNormalArray(a.select_options),a.select_value=a.select_options,null!=a.select_options&&a.select_options.length>0&&(a.value=a.select_options[0])):"decimal"==a.dt_code&&"YES"==a.form_field_visibility&&a.value>0?a.value=parseFloat(a.value,10).toFixed(2):"date"==a.dt_code&&(a.value=e.$options.filters.formatDate(a.value))}))),u.length>0){var c={group_id:o,group_name:u[0].group_name,group_display_name:u[0].group_display_name,Data:u};e.GroupBy.push(c)}}}),this)),e.contactId>0){var r={};e.LeadData.forEach((function(e){""!=e.astype&&"YES"==e.form_field_visibility&&(r[e.name]=e.value)})),e.$refs.form.resetForm({values:r})}}setTimeout((function(){e.CheckBoxBootstrap()}),100),setTimeout((function(){e.RadioButtonBootstrap()}),500)}))},onCancel:function(){this.$router.push({name:"ContactListing"})}}},c=u,d=(a("72d2"),a("2877")),p=Object(d["a"])(c,i,n,!1,null,null,null);t["default"]=p.exports},fbc1:function(e,t,a){var i=a("8000");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("499e").default;n("98805762",i,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=CRMManageContact.js.map